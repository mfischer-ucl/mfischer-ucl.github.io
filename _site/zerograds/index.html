<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.27.3 by Michael Rose
  Copyright 2013-2025 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Michael Fischer</title>
<meta name="description" content="Michael Fischer, PhD Student in AI and Computer Graphics at University College London (UCL).">


  <meta name="author" content="Michael Fischer">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Michael Fischer">
<meta property="og:title" content="Michael Fischer">
<meta property="og:url" content="http://localhost:4000/zerograds/">


  <meta property="og:description" content="Michael Fischer, PhD Student in AI and Computer Graphics at University College London (UCL).">












<link rel="canonical" href="http://localhost:4000/zerograds/">












<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Michael Fischer Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
<link rel="stylesheet" href="/assets/css/academicons.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Michael Fischer
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/"
                
                
              >Home</a>
            </li><li class="masthead__menu-item">
              <a
                href="/news/"
                
                
              >News</a>
            </li><li class="masthead__menu-item">
              <a
                href="/publications/"
                
                
              >Publications</a>
            </li><li class="masthead__menu-item">
              <a
                href="/contact/"
                
                
              >Contact</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          
          


        </header>
      

      <section class="page__content" itemprop="text">
        
        
<style>

.mybutton {
  background-color: #fff;
  border: 1px solid #d5d9d9;
  border-radius: 5px;
  box-shadow: rgba(213, 217, 217, .5) 0 2px 5px 0;
  box-sizing: border-box;
  color: #000000;
  cursor: pointer;
  display: inline-block;
  font-family: "Amazon Ember", sans-serif;
  font-size: 10.5px;
  line-height: 18px;
  padding: 0 10px 0 10px;
  position: relative;
  text-align: center;
  text-decoration: none;
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  vertical-align: middle;
  width: width: fit-content;
}

.content {
  padding: 0 18px;
  display: none;
  overflow: hidden;
  background-color: #f1f1f1;
  margin-bottom: 33px;
}

.collapsible {
  background-color: #f1f1f1;
  color: #444;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  border: none;
  text-align: center;
  outline: none;
  font-size: 15px;
  position: relative;
  margin-bottom: 10px;
}

.collapsible::before {
  content: '\002B';
  color: #777;
  font-weight: bold;
  margin-right: 5px;
}

.active::before {
  content: "\2212";
}

sup {
    text-decoration: none; 
    color: black;
}

.mybutton:hover {
  background-color: #f7fafa;
}

.mybutton:focus {
  border-color: #008296;
  box-shadow: rgba(213, 217, 217, .5) 0 2px 5px 0;
  outline: 0;
}

.top-image-container {
    display: flex;
    justify-content: center; /* Center the images horizontally */
    align-items: center; /* Center the images vertically */
    margin-bottom: 0px; /* Spacing between the images and the video containers */
    margin-top: 33px; /* Spacing between the images and the video containers */
    width: 50%; /* Reducing the container's width to 50% */
    margin-left: auto; /* Auto-adjusting left margin */
    margin-right: auto; /* Auto-adjusting right margin */
}

.top-image-container img {
    margin: 0 30px; /* Adjust space between the images */
    max-width: 60%; /* Ensure images don't overflow their container */
    height: auto; /* Maintain aspect ratio */
}

.videos-flex-container {
    display: flex;
    justify-content: center; /* Adjust this to change the alignment of videos */
    flex-wrap: wrap; /* Allows the items to wrap to the next line */
    margin-bottom: 10px;
}

#NAvideoForm {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: flex-start;
    flex-wrap: wrap;
    margin-top: 5px;
    margin-bottom: 25px;
    background-color: #F8F8F8;
    padding: 20px;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
    border-radius: 10px;
}

.NAvideo-container {
    margin: 3px;
    text-align: center;
    flex: 1; /* Allow each container to grow and shrink as needed */
    max-width: 20%; /* Adjust this value based on your layout */
    box-sizing: border-box; /* Ensure padding and borders are included */
    padding: 0; /* Remove any default padding */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
}

.NAvideo-container video {
    max-width: 100%;
    height: auto;
}

.caption {
    text-align: center;
    margin-top: 5px;
    max-width: 95%;
    overflow: hidden; /* Hide any overflowed caption text */
    text-overflow: ellipsis; /* Add an ellipsis for long captions */
    white-space: nowrap; /* Prevent captions from wrapping to the next line */
}

.media-flex-container {
    flex-basis: calc(48.0% - 20px);
    display: flex;
    justify-content: center;
    align-items: center;
    
}

.media-item {
    margin: 0 10px 0 0;
    text-align: center;
    flex-basis: 33%;
}

.media-item img, .media-item video {
    max-width: 100%;
    height: auto;
}

.parent-flex-container {
    margin-top: 10px;
    margin-bottom: 50px;
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 50px;
}

video {
    max-width: 100%;
    height: auto;
    box-sizing: border-box; /* Ensure padding and borders are included in the element's total width and height */
}

.radio-buttons {
    margin-top: 2px;
}


.row {
  margin-left: -15px;
  margin-right: -15px;
}

h2, h4 {
  text-align: center;
}

h3 {
   text-align: left;
}

h4, .h4, h5, .h5, h6, .h6 {
  margin-top: 10.5px;
  margin-bottom: 10.5px;
}

.horizItem {
    display: inline-block; 
    margin-left: 3%; 
    margin-right: 3%;
}

.grey-box {
  background-color: #f2f2f2;
  padding: 20px;
  box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
  border-radius: 10px;
}

figure{
display: inline-block;
}

.cite-box {
  background-color: #f7f7f7; 
  line-height: 110%;
  box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); 
  border-radius: 3px;
  padding: 10px;
}

.vidcontainer {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  margin-bottom: 15px;
}

.teaserbutton {
    height: 80px; /* Default height for larger screens */
    width: auto; /* Maintain aspect ratio */
}


/* Media query for tablets */
@media (max-width: 768px) {
    .teaserbutton {
        height: 60px; /* Smaller height for tablets */
    }
  .media-flex-container {
        flex-basis: 100%;
    }
}

/* Media query for mobile devices */
@media (max-width: 480px) {
    .teaserbutton {
        height: 40px; /* Even smaller height for mobile devices */
    }
  .media-flex-container {
        flex-basis: 100%;
    }
}

.globaldiv {
    font-size: 16px; 
    margin-left: -25%;
}

@media screen and (max-width: 768px) {
    
    .grey-box {
        max-width: 100%;
    }

    .cite-box {
        max-width: 100%;
    }    

    .vidcontainer {
        max-width: 100%;
    }

    .caption {
        max-width: 100%;
    }

    .globaldiv {
        max-width: 100%;
        margin-left: 0%;
    }
}

</style>

<style>
    .container {
        width: 100%;
        margin: auto;
        text-align: center;
    }
    
    .containerimg {
        width: 90%;
        margin: auto;
    }

    .caption {
        font-size: 0.9em;
        color: #666;
    }

    .image-section img {
            float: right; /* Image floats to the right */
            width: 45%; /* Image takes up 50% of the linewidth */
            margin-left: 20px; /* Adds space between the text and the image */
            margin-bottom: 5px; /* Adds space between the text and the image */
    }

ol > li::marker {
  font-weight: bold;
}
</style>

<body>
<div class="globaldiv">

<div class="grey-box">
<br />
<p style="margin: 0 auto; text-align: center;">
<span style="font-size: 24px;"><b>ZeroGrads: Learning Local Surrogate Losses for Non-Differentiable Graphics</b></span> <br /><br />
<span style="font-size: 17px; color: black">SIGGRAPH 2024</span><br /><br />
<span style="font-size: 17px;"><a href="https://mfischer-ucl.github.io/">Michael Fischer</a>, <a href="https://www.homepages.ucl.ac.uk/~ucactri/">Tobias Ritschel</a></span><br />
<a style="font-size: 14px;" href="https://www.ucl.ac.uk/">University College London</a>
</p>
<br />
</div>

<div style="display: flex; justify-content: center; align-items: center; margin-top: 2%">
  <img src="/assets/images/zerograds/teaser.png" style="width: 60%" />
</div>

<div class="row" style="margin: 50px 0 50px 0">
    <div style="display: inline">
        <ul style="list-style: none; text-align: center">
            <li class="horizItem">
                <a href="https://arxiv.org/abs/2308.05739">
                <img class="teaserbutton" src="/assets/images/zerograds/paperfront.png" /><br />
                    <h4><strong>Paper</strong></h4>
                </a>
            </li>
            <li class="horizItem">
                <a href="https://colab.research.google.com/drive/1GNd6DdRGRHQjKyG3rIfJ9519lo9VuAq4?usp=sharing">
                <img class="teaserbutton" src="/assets/images/colablogo.png" /><br />
                    <h4><strong>Colab (simple example)</strong></h4>
                </a>
            </li>
            <li class="horizItem">
                <a href="https://github.com/mfischer-ucl/zerograds">
                <img class="teaserbutton" src="/assets/images/gh_icon.png" /><br />
                    <h4><strong>Code</strong></h4>
                </a>
            </li>
            <li class="horizItem">
                <a href="/assets/zerograds_supplemental.pdf" download="zerograds_supplemental.pdf">
                <img class="teaserbutton" src="/assets/images/paperclip.png" /><br />
                    <h4><strong>Supplemental</strong></h4>
                </a>
            </li>
        </ul>
    </div>
</div>

<b>TLDR:</b><br />
<p style="text-align: justify">
We learn a mapping between optimization parameters and their corresponding loss values, our neural surrogate loss, 
whose gradients we can then use for running gradient descent on arbitrary, high-dimensional black-box forward models. 
</p>

<b>Abstract:</b><br />
<p style="text-align: justify">
Gradient-based optimization is now ubiquitous across graphics, but unfortunately can not be applied to problems with undefined or zero gradients.
To circumvent this issue, the loss function can be manually replaced by a ``surrogate'' that has similar minima but is differentiable.
Our proposed framework, ZeroGrads, automates this process by learning a neural approximation of the objective function, which in turn can be used to differentiate through arbitrary black-box graphics pipelines.
We train the surrogate on an actively smoothed version of the objective and encourage locality, focusing the surrogate's capacity on what matters at the current training episode.
The fitting is performed online, alongside the parameter optimization, and self-supervised, without pre-computed data or pre-trained models.
As sampling the objective is expensive (it requires a full rendering or simulator run), we devise an efficient sampling scheme that allows for tractable run-times and competitive performance at little overhead. 
We demonstrate optimizing diverse non-convex, non-differentiable black-box problems in graphics, such as visibility in rendering, discrete parameter spaces in procedural modelling or optimal control in physics-driven animation. 
In contrast to other derivative-free algorithms, our approach scales well to higher dimensions, which we demonstrate on problems with up to 35k interlinked variables.
</p>

<b>Method:</b><br />


<div class="image-section">
    <img src="/assets/images/zerograds/gradflow.png" />
</div>
<p>In ZeroGrads, we deal with the problem that many programs are not differentiable by design - for instance, as they're
   not written in a differentiable programming language, or simply were made for another user group (Photoshop, GIMP, ...). 
   We therefore have no way of backpropagating through these programs (red arrow in the figure on the right).   
   However, in this paper we show that we can still differentiate these programs if we can find a analytical mapping from the program input
   (the optimization parameters) to "how wrong" the output is, i.e., the loss function's value for these parameters. 
   Once we have found such a mapping, we can use its gradients as "surrogate gradients" during gradient descent, and thus differentiate
   through non-differentiable programs (green arrows in the figure on the right) like Blender or Matplotlib.   
</p>


However, it is often the case that large parts of this parameter space are irrelevant for the current optimization state, 
which is why we constrain our surrogate model to the local neighbourhood by sampling from a Gaussian. The surrogate 
therefore can "focus on what matters" at the current optimization step. In simple words, the four key steps in ZeroGrads are:  

<ol type="1">
  <li>Smooth the loss landscape via convolution with a Gaussian kernel, a trick introduced in <a href="/prdpt">PRDPT</a>.</li>
  <li>Locally sample around the current parameter state to produce samples for our surrogate fitting.</li>
  <li>Fit an analytical function (we use an MLP) to these samples.</li>
  <li>Compute the gradient of the MLP w.r.t. the optimization parameters, and use this gradient to perform an (Adam-) gradient descent step.</li>
</ol>  

We provide a <a href="https://colab.research.google.com/drive/1GNd6DdRGRHQjKyG3rIfJ9519lo9VuAq4?usp=sharing">Colab Notebook</a> that shows a simple example and how ZeroGrads outperforms its competitors. 

<br />
<br />
<b>Results:</b><br />
We compare our method against the traditional derivative-free optimizers Simulated Annealing (SA), Genetic Algorithms (GA), 
Simultaneous Perturbation Stochastic Spproximation (SPSA), Covariance Matrix Adaption Evolutionary Strategy (CMA-ES), and our 
previously published gradient estimator <a href="/prdpt">PRDPT</a>, here denoted as FR22. 
<br />
<br />

<div class="container">
    <img class="containerimg" src="/assets/images/zerograds/caustic.png" />
    <div class="caption">In this experiment, we optimize a heightfield such that the resulting caustic matches a reference.
    The heightfield is parametrized as a 1,024-dimensional spline.</div>
</div>
<br />
<br />

<div class="container">
    <img class="containerimg" src="/assets/images/zerograds/texture.png" />
    <div class="caption">Here, we optimize the 196,608 color values of a 256x256 RGB texture. CMA-ES cannot be run on
    this example due to its quadratic memory complexity.</div>
</div>
<br />
<br />

<div class="container">
    <img class="containerimg" src="/assets/images/zerograds/mlp.png" />
    <div class="caption">In this example, we optimize the 35,152 weights of an MLP such that it encodes digits from the MNIST dataset.</div>
</div>
<br />
<br />

<div class="container">
    <img class="containerimg" src="/assets/images/zerograds/mesh.png" />
    <div class="caption">In this inverse rendering scenario, the task is to deform a tesselated sphere into a mesh that 
    explains the reference views. "Diff. Rendering" implements the Largesteps approach by Nicolet et al., 2021.</div>
</div>
<br />
<br />

<div class="image-section">
    <img src="/assets/images/zerograds/vae_schematic.png" />
</div>
<p>Finally, in this example, we train a <b>generative model</b> on a <b>non-differentiable task</b>. Specifically, we use
   a VAE that learns to encode digits from the MNIST dataset. However, instead of simply decoding the latents to pixel 
   values, the VAE produces spline-support-points, which are then rendered with a non-differentiable spline renderer (see the figure on the right for a schematic). 
   We use a weighted mixture of MSE and KLD as the trainig loss and backpropagate this loss through the non-diff. spline
   renderer (i.e., from the rendered spline to the VAE weights) using our proposed method ZeroGrads. The below digits 
   are samples from the latent space of the trained VAE, in a variety of styles, which are easily applicable in post-processing 
   thanks to the spline formulation.<br />    
</p>

<div class="container">
    <img class="containerimg" src="/assets/images/zerograds/vae.png" />
    <div class="caption"></div>
</div>

<br />

The magic that makes our approach scale to high dimensions is the surrogate's hysteresis, which reduces the gradient 
variance. In contrast to methods that re-build a linear gradient estimate from scratch at every optimization iteration, 
the MLP's spectral bias prevents rapid changes and thus achieves a smoother gradient trajectory over time.
We plan to explore this further in future research. 

<br />
<br />

<b>Citation</b><br />
If you find our work useful and use parts or ideas of our paper or code, please cite: <br />
<p class="cite-box" style="margin-top: 5px">
  <span style="font-family: Lucida Console, Courier New, monospace; padding: 10px; font-size: 85%">
    @article{fischer2024zerograds, <br />
      &nbsp;&nbsp;title={ZeroGrads: Learning Local Surrogates for Non-Differentiable Graphics}, <br />
      &nbsp;&nbsp;author={Fischer, Michael and Ritschel, Tobias}, <br />
      &nbsp;&nbsp;journal={ACM Transactions on Graphics (TOG)}, <br />
      &nbsp;&nbsp;volume={43}, <br />
      &nbsp;&nbsp;number={4}, <br />
      &nbsp;&nbsp;pages={1--15}, <br />
      &nbsp;&nbsp;year={2024}, <br />
      &nbsp;&nbsp;publisher={ACM New York, NY, USA} <br />
    }
  </span>
</p>

<b>Acknowledgements</b><br />
We extend our gratitude to the anonymous reviewers for their insightful feedback and to 
Meta Reality Labs for their continuous support. 
Additionally, we are thankful for the support provided by the Rabin Ezra Scholarship Trust.

</div>
</body>

        
      </section>

      <footer class="page__meta">
        
        


        

      </footer>

      

      

    </div>

    
  </article>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    

    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>


<div class="page__footer-copyright">&copy; 2026 <a href="http://localhost:4000">Michael Fischer</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
